{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { TechnicalDataSheet } from '../../../models/TechnicalDataSheet';\nimport Swal from 'sweetalert2';\nlet ViewTechnicalSheetComponent = class ViewTechnicalSheetComponent {\n  constructor(technicalSheetService, activatedRoute, router, authService) {\n    this.technicalSheetService = technicalSheetService;\n    this.activatedRoute = activatedRoute;\n    this.router = router;\n    this.authService = authService;\n    this.title = 'Vista previa de ficha técnica';\n    this.loading = false; // Flag variable\n    // Eliminamos la instancia de PanZoomConfig\n    this.panzoomConfig = {\n      zoomLevels: 5,\n      scalePerZoomLevel: 2,\n      zoomStepDuration: 0.2,\n      freeMouseWheel: false,\n      dynamicContentDimensions: true,\n      overflow: 'visible',\n      // Añade estas propiedades:\n      initialZoomLevel: 0,\n      neutralZoomLevel: 0,\n      keepInBounds: true\n    };\n  }\n  ngOnInit() {\n    this.captureRoute();\n  }\n  captureRoute() {\n    this.technicalDataSheetCurrent = new TechnicalDataSheet();\n    this.activatedRoute.params.subscribe(({\n      id\n    }) => this.loadChip(id));\n  }\n  loadChip(id) {\n    this.technicalSheetService.getById(id).subscribe(resp => {\n      this.technicalDataSheetCurrent = resp;\n      console.log(this.technicalDataSheetCurrent);\n    }, error => {\n      Swal.fire('Error de carga', 'La información de la ficha no se ha cargado correctamente', 'error');\n    });\n  }\n  approveTechnicalSheet() {\n    this.loading = true;\n    let currentStatus = this.technicalDataSheetCurrent.status;\n    let status = this.calculateApproveNewStatus(this.technicalDataSheetCurrent.status);\n    this.technicalSheetService.saveFicha(this.technicalDataSheetCurrent).subscribe(obj => {\n      this.loading = false;\n      Swal.fire({\n        title: 'Correcto',\n        html: `Los datos han sido guardadas correctamente `,\n        icon: 'success',\n        timer: 3000,\n        timerProgressBar: true\n      });\n      this.router.navigate([`/listTechnicalDataSheet/page/0/${currentStatus}`]);\n    }, error => Swal.fire({\n      title: 'Error',\n      html: `Ha ocurrido un error al actualizar la ficha`,\n      icon: 'error',\n      timer: 3000,\n      timerProgressBar: true\n    }));\n  }\n  calculateApproveNewStatus(status) {\n    switch (status) {\n      case 'DESARROLLO':\n        {\n          this.technicalDataSheetCurrent.status = 'PRIMERA REVISION';\n          this.technicalDataSheetCurrent.qaComments = '';\n          this.technicalDataSheetCurrent.editComments = '';\n          return 'PRIMERA REVISION';\n        }\n      case 'PRIMERA REVISION':\n        {\n          this.technicalDataSheetCurrent.userValidation = `${this.authService.user.firstName}  ${this.authService.user.lastName}`.toUpperCase();\n          this.technicalDataSheetCurrent.status = 'SEGUNDA REVISION';\n          return 'SEGUNDA REVISION';\n        }\n      case 'SEGUNDA REVISION':\n        {\n          this.technicalDataSheetCurrent.userApproved = `${this.authService.user.firstName}  ${this.authService.user.lastName}`.toUpperCase();\n          this.technicalDataSheetCurrent.status = 'TERMINADO';\n          return 'TERMINADO';\n        }\n      case 'CALIDAD':\n        {\n          this.technicalDataSheetCurrent.status = 'DESARROLLO';\n          return 'DESARROLLO';\n        }\n      case 'TERMINADO':\n        {\n          this.technicalDataSheetCurrent.status = 'CALIDAD';\n          return 'CALIDAD';\n        }\n      default:\n        {\n          return 'DESARROLLO';\n        }\n    }\n  }\n  calculateDisapproveNewStatus(status) {\n    switch (status) {\n      case 'DESARROLLO':\n        {\n          this.technicalDataSheetCurrent.status = 'ELIMINADO';\n          this.technicalDataSheetCurrent.qaComments = '';\n          this.technicalDataSheetCurrent.editComments = '';\n          return 'DESARROLLO';\n        }\n      case 'PRIMERA REVISION':\n        {\n          this.technicalDataSheetCurrent.userValidation = `${this.authService.user.firstName.toUpperCase()} ${this.authService.user.lastName.toUpperCase()}`;\n          this.technicalDataSheetCurrent.status = 'DESARROLLO';\n          return 'PRIMERA REVISION';\n        }\n      case 'SEGUNDA REVISION':\n        {\n          this.technicalDataSheetCurrent.userApproved = `${this.authService.user.firstName.toUpperCase()} ${this.authService.user.lastName.toUpperCase()}`;\n          this.technicalDataSheetCurrent.status = 'DESARROLLO';\n          return 'SEGUNDA REVISION';\n        }\n      case 'CALIDAD':\n        {\n          this.technicalDataSheetCurrent.status = 'DESARROLLO';\n          return 'CALIDAD';\n        }\n      case 'TERMINADO':\n        {\n          this.technicalDataSheetCurrent.status = 'CALIDAD';\n          return 'TERMINADO';\n        }\n      default:\n        {\n          return 'DESARROLLO';\n        }\n    }\n  }\n  disapproveTechnicalSheet() {\n    this.loading = true;\n    let currentStatus = this.technicalDataSheetCurrent.status;\n    let status = this.calculateDisapproveNewStatus(this.technicalDataSheetCurrent.status);\n    this.technicalSheetService.saveFicha(this.technicalDataSheetCurrent).subscribe(obj => {\n      this.loading = false;\n      Swal.fire({\n        title: 'Correcto',\n        html: `Los datos han sido guardadas correctamente `,\n        icon: 'success',\n        timer: 3000,\n        timerProgressBar: true\n      });\n      this.router.navigate([`/listTechnicalDataSheet/page/0/${currentStatus}`]);\n    }, error => Swal.fire({\n      title: 'Error',\n      html: `Ha ocurrido un error al actualizar la ficha`,\n      icon: 'error',\n      timer: 3000,\n      timerProgressBar: true\n    }));\n  }\n};\nViewTechnicalSheetComponent = __decorate([Component({\n  selector: 'app-view-technical-sheet',\n  templateUrl: './view-technical-sheet.component.html',\n  styleUrls: ['./view-technical-sheet.component.css']\n})], ViewTechnicalSheetComponent);\nexport { ViewTechnicalSheetComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}