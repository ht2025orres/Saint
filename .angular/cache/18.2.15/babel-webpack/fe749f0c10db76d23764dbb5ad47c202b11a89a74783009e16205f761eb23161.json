{"ast":null,"code":"import _asyncToGenerator from \"C:/saint-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport Swal from 'sweetalert2';\nimport { Chart } from 'chart.js';\nimport * as XLSX from 'xlsx';\nimport { saveAs } from 'file-saver';\nimport { jsPDF } from 'jspdf';\nimport * as moment from 'moment';\nimport { lastValueFrom } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/technical-data-sheets-report.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nfunction TechnicalDataSheetsReportComponent_option_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 31);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const month_r2 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", month_r2.value);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(month_r2.name);\n  }\n}\nfunction TechnicalDataSheetsReportComponent_option_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 31);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const year_r3 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", year_r3);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(year_r3);\n  }\n}\nfunction TechnicalDataSheetsReportComponent_span_36_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"Limpiar filtro\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TechnicalDataSheetsReportComponent_span_37_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"Cargando...\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TechnicalDataSheetsReportComponent_tbody_56_tr_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"th\", 33);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵpipe(9, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"td\");\n    i0.ɵɵtext(11);\n    i0.ɵɵpipe(12, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"td\");\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const item_r4 = ctx.$implicit;\n    const i_r5 = ctx.index;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i_r5 + 1);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(item_r4.id_item);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(item_r4.technical_data_sheet_type);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(9, 6, item_r4.date_creation, \"longDate\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(12, 9, item_r4.last_update, \"longDate\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(item_r4.status);\n  }\n}\nfunction TechnicalDataSheetsReportComponent_tbody_56_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tbody\");\n    i0.ɵɵtemplate(1, TechnicalDataSheetsReportComponent_tbody_56_tr_1_Template, 15, 12, \"tr\", 32);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", ctx_r5.filteredTable);\n  }\n}\nfunction TechnicalDataSheetsReportComponent_ng_template_57_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\", 34);\n    i0.ɵɵtext(2, \"No se encontraron resultados\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction TechnicalDataSheetsReportComponent_div_59_div_6_a_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"a\", 41);\n    i0.ɵɵlistener(\"click\", function TechnicalDataSheetsReportComponent_div_59_div_6_a_1_Template_a_click_0_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r5 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r5.changePage(ctx_r5.paginator.number - 1));\n    });\n    i0.ɵɵtext(1, \" Anterior \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TechnicalDataSheetsReportComponent_div_59_div_6_span_3_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 44);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const pagina_r8 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", pagina_r8, \" \");\n  }\n}\nfunction TechnicalDataSheetsReportComponent_div_59_div_6_span_3_a_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"a\", 45);\n    i0.ɵɵlistener(\"click\", function TechnicalDataSheetsReportComponent_div_59_div_6_span_3_a_2_Template_a_click_0_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const pagina_r8 = i0.ɵɵnextContext().$implicit;\n      const ctx_r5 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r5.changePage(pagina_r8 - 1));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const pagina_r8 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", pagina_r8, \" \");\n  }\n}\nfunction TechnicalDataSheetsReportComponent_div_59_div_6_span_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtemplate(1, TechnicalDataSheetsReportComponent_div_59_div_6_span_3_span_1_Template, 2, 1, \"span\", 42)(2, TechnicalDataSheetsReportComponent_div_59_div_6_span_3_a_2_Template, 2, 1, \"a\", 43);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const pagina_r8 = ctx.$implicit;\n    const ctx_r5 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", pagina_r8 - 1 === ctx_r5.paginator.number);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", pagina_r8 - 1 !== ctx_r5.paginator.number);\n  }\n}\nfunction TechnicalDataSheetsReportComponent_div_59_div_6_a_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"a\", 46);\n    i0.ɵɵlistener(\"click\", function TechnicalDataSheetsReportComponent_div_59_div_6_a_4_Template_a_click_0_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r5 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r5.changePage(ctx_r5.paginator.number + 1));\n    });\n    i0.ɵɵtext(1, \" Siguiente \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TechnicalDataSheetsReportComponent_div_59_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 38);\n    i0.ɵɵtemplate(1, TechnicalDataSheetsReportComponent_div_59_div_6_a_1_Template, 2, 0, \"a\", 39);\n    i0.ɵɵelementStart(2, \"span\");\n    i0.ɵɵtemplate(3, TechnicalDataSheetsReportComponent_div_59_div_6_span_3_Template, 3, 2, \"span\", 32);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(4, TechnicalDataSheetsReportComponent_div_59_div_6_a_4_Template, 2, 0, \"a\", 40);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r5.paginator.number > 0);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r5.getVisiblePages());\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r5.paginator.number < ctx_r5.paginator.totalPages - 1);\n  }\n}\nfunction TechnicalDataSheetsReportComponent_div_59_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 14)(1, \"div\")(2, \"div\", 35)(3, \"p\", 36);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(5, \"div\");\n    i0.ɵɵtemplate(6, TechnicalDataSheetsReportComponent_div_59_div_6_Template, 5, 3, \"div\", 37);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate3(\" Mostrando del \", ctx_r5.getStartIndex(), \" al \", ctx_r5.getEndIndex(), \" de \", ctx_r5.paginator.totalElements, \" entrada(s) \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", (ctx_r5.pages == null ? null : ctx_r5.pages.length) > 0);\n  }\n}\nexport let TechnicalDataSheetsReportComponent = /*#__PURE__*/(() => {\n  class TechnicalDataSheetsReportComponent {\n    constructor(technicalreportservices) {\n      this.technicalreportservices = technicalreportservices;\n      this.loading = false;\n      this.isModalOpen = false;\n      this.filteredTable = [];\n      this.filterGrafi = [];\n      this.datos_table = [];\n      this.cantidadop = 0;\n      this.cantidadfc = 0;\n      this.cantidadfcs = 0;\n      this.datosFiltro = [];\n      // Agregar estas nuevas propiedades\n      this.textoFiltro = '';\n      this.tipoFiltro = 'todos'; // Filtro predeterminado\n      this.months = [{\n        value: '1',\n        name: 'Enero'\n      }, {\n        value: '2',\n        name: 'Febrero'\n      }, {\n        value: '3',\n        name: 'Marzo'\n      }, {\n        value: '4',\n        name: 'Abril'\n      }, {\n        value: '5',\n        name: 'Mayo'\n      }, {\n        value: '6',\n        name: 'Junio'\n      }, {\n        value: '7',\n        name: 'Julio'\n      }, {\n        value: '8',\n        name: 'Agosto'\n      }, {\n        value: '9',\n        name: 'Septiembre'\n      }, {\n        value: '10',\n        name: 'Octubre'\n      }, {\n        value: '11',\n        name: 'Noviembre'\n      }, {\n        value: '12',\n        name: 'Diciembre'\n      }];\n      this.years = Array.from({\n        length: moment().year() - 2020\n      }, (_, i) => moment().year() - i).sort((a, b) => b - a);\n      this.selectedMonth = moment().month() + 1; // Convertimos a string porque el <select> usa strings\n      this.selectedYear = moment().year();\n    }\n    ngOnInit() {\n      this.reloadListdb();\n    }\n    reloadListdb() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        try {\n          _this.loading = true;\n          console.log('⏳ Cargando datos...');\n          const response = yield lastValueFrom(_this.technicalreportservices.getAlldb());\n          console.log('✅ Datos cargados:', response);\n          _this.datos_table = response;\n          _this.datosFiltro = _this.datos_table;\n          _this.filteredTable = _this.datos_table.slice(0, 15);\n          _this.configurePaginator(_this.datos_table);\n          _this.filterByMonth();\n        } catch (error) {\n          Swal.fire('Error', 'No se han podido cargar los datos', 'error');\n        } finally {\n          _this.loading = false;\n        }\n      })();\n    }\n    setDefaultFilters() {\n      const now = moment();\n      this.selectedMonth = now.month() + 1; // Moment.js usa meses de 0-11, sumamos 1.\n      this.selectedYear = now.year();\n    }\n    filterByMonth() {\n      if (!this.selectedMonth || !this.selectedYear) return;\n      this.filterGrafi = this.datos_table.filter(item => {\n        if (!item.date_creation) return false;\n        // Parsear la fecha usando moment directamente\n        const itemDate = moment(item.date_creation, 'YYYY-MM-DD');\n        const itemYear = itemDate.year();\n        const itemMonth = itemDate.month() + 1;\n        return itemYear === Number(this.selectedYear) && itemMonth === Number(this.selectedMonth);\n      });\n      // Actualizar contadores y gráfico\n      this.cantidadop = this.countMatchingItems('OPM');\n      this.cantidadfc = this.countMatchingItems('FICHA TECNICA');\n      this.cantidadfcs = this.countMatchingItems('FICHAS TECNICAS');\n      if (this.chart) {\n        this.chart.destroy();\n      }\n      this.createChart();\n    }\n    resetFilters() {\n      this.setDefaultFilters(); // Llamamos la función que pone los valores por defecto\n      this.filterByMonth();\n    }\n    aplicarFiltro() {\n      // Si no hay filtro, restaurar datos originales\n      if (!this.textoFiltro.trim() && this.tipoFiltro === 'todos') {\n        this.datosFiltro = this.datos_table;\n        this.filteredTable = this.datosFiltro.slice(0, this.paginator.size);\n        this.configurePaginator(this.datosFiltro);\n        return;\n      }\n      const textoBusqueda = this.textoFiltro.toLowerCase().trim();\n      // Aplicar filtro\n      this.datosFiltro = this.datos_table.filter(item => {\n        if (this.tipoFiltro !== 'todos') {\n          const valor = {\n            'codigoItem': item.id_item,\n            'tipo': item.technical_data_sheet_type,\n            'fecha': item.date_creation instanceof Date ? item.date_creation.toLocaleDateString() : String(item.date_creation),\n            'estado': item.status\n          }[this.tipoFiltro];\n          return valor?.toLowerCase().includes(textoBusqueda);\n        }\n        return item.id_item?.toLowerCase().includes(textoBusqueda) || item.technical_data_sheet_type?.toLowerCase().includes(textoBusqueda) || String(item.date_creation).toLowerCase().includes(textoBusqueda) || item.status?.toLowerCase().includes(textoBusqueda);\n      });\n      // Actualizar tabla y paginador\n      this.filteredTable = this.datosFiltro.slice(0, this.paginator.size);\n      this.configurePaginator(this.datosFiltro);\n      this.paginator.number = 0;\n    }\n    // Método para limpiar el filtro sin recargar la página\n    limpiarFiltro() {\n      this.textoFiltro = '';\n      this.tipoFiltro = 'todos';\n      this.datosFiltro = this.datos_table;\n      this.filteredTable = this.datosFiltro.slice(0, this.paginator.size);\n      this.configurePaginator(this.datos_table);\n    }\n    // Nuevo método para recargar la tabla\n    recargarTabla() {\n      // Recargar los datos originales\n      this.reloadListdb();\n      // Reiniciar la paginación\n      this.configurePaginator(this.datos_table);\n      this.filteredTable = this.datos_table.slice(0, this.paginator.size);\n      this.datosFiltro = this.datos_table;\n      // Volver a la primera página\n      if (this.paginator) {\n        this.paginator.number = 0;\n        this.initPaginator(this.paginator);\n      }\n    }\n    countMatchingItems(value) {\n      return this.filterGrafi.filter(item => {\n        if (!item.date_creation) return false;\n        const itemDate = moment(item.date_creation, 'YYYY-MM-DD');\n        const matchesType = item.technical_data_sheet_type?.toUpperCase().includes(value.toUpperCase());\n        return matchesType;\n      }).length;\n    }\n    createChart() {\n      this.chart = new Chart(\"MyChart\", {\n        type: 'bar',\n        data: {\n          labels: ['Categorías Del Reporte Grafico'],\n          datasets: [{\n            label: \"OPM\",\n            data: [this.cantidadop],\n            backgroundColor: '#90A4AE',\n            borderColor: '#000',\n            borderWidth: 1\n          }, {\n            label: \"FICHAS TECNICAS\",\n            data: [this.cantidadfcs],\n            backgroundColor: '#5C6BC0',\n            borderColor: '#000',\n            borderWidth: 1\n          }, {\n            label: \"FICHA TECNICA\",\n            data: [this.cantidadfc],\n            backgroundColor: '#64B5F6',\n            borderColor: '#000',\n            borderWidth: 1\n          }]\n        },\n        options: {\n          responsive: true,\n          aspectRatio: 2.5,\n          scales: {\n            y: {\n              ticks: {\n                stepSize: 1\n              }\n            }\n          }\n        }\n      });\n    }\n    configurePaginator(data) {\n      const pageSize = 15;\n      this.paginator = {\n        content: data,\n        totalElements: data.length,\n        totalPages: Math.ceil(data.length / pageSize),\n        number: 0,\n        numberOfElements: Math.min(pageSize, data.length),\n        size: pageSize\n      };\n      this.initPaginator(this.paginator);\n    }\n    initPaginator(response) {\n      const begin = Math.min(Math.max(1, response.number - 4), response.totalPages - 5);\n      const end = Math.max(Math.min(response.totalPages, response.number + 4), 6);\n      if (response.totalPages > 5) {\n        this.pages = new Array(end - begin + 1).fill(0).map((valor, indice) => indice + begin);\n      } else {\n        this.pages = new Array(response.totalPages).fill(0).map((valor, indice) => indice + 1);\n      }\n    }\n    changePage(page) {\n      const startIndex = page * this.paginator.size;\n      this.filteredTable = this.datosFiltro.slice(startIndex, startIndex + this.paginator.size);\n      this.paginator.number = page;\n      this.initPaginator(this.paginator);\n    }\n    getStartIndex() {\n      return this.paginator.number * this.paginator.size + 1;\n    }\n    getEndIndex() {\n      const endIndex = (this.paginator.number + 1) * this.paginator.size;\n      return Math.min(endIndex, this.paginator.totalElements);\n    }\n    openModal() {\n      this.isModalOpen = true;\n    }\n    closeModal() {\n      this.isModalOpen = false;\n    }\n    download(format) {\n      if (format === 'excel') {\n        this.exportToExcel();\n      } else if (format === 'pdf') {\n        this.exportToPDF();\n      }\n      this.closeModal();\n    }\n    exportToExcel() {\n      const worksheet = XLSX.utils.json_to_sheet(this.datosFiltro);\n      const workbook = {\n        Sheets: {\n          'DatosTabla': worksheet\n        },\n        SheetNames: ['DatosTabla']\n      };\n      // Formato: \"2025-02-13 08:17 AM\"\n      const now = moment().format('YYYY-MM-DD hh:mm A');\n      // Nombre del archivo con la fecha y hora\n      const fileName = `Reporte Fichas ${now}.xlsx`;\n      const excelBuffer = XLSX.write(workbook, {\n        bookType: 'xlsx',\n        type: 'array'\n      });\n      const data = new Blob([excelBuffer], {\n        type: 'application/octet-stream'\n      });\n      saveAs(data, fileName);\n    }\n    exportToPDF() {\n      try {\n        //Crear PDF en modo horizontal\n        const doc = new jsPDF({\n          orientation: 'landscape',\n          unit: 'mm',\n          format: 'a4'\n        });\n        doc.setFontSize(16);\n        doc.text('Reporte de Datos', 15, 15);\n        //Preparar datos para la tabla (usar filteredTable)\n        const tableData = this.filteredTable.map((item, index) => [(index + 1).toString(), item.id_item || '', item.technical_data_sheet_type || '',\n        // Compatibilidad con versiones anteriores de Angular\n        item.date_creation && item.date_creation.toDate ? item.date_creation.toDate().toLocaleDateString() : item.date_creation || '', item.status || '']);\n        // Uso de autoTable con verificación de tipado\n        doc.autoTable({\n          head: [['#', 'Código ítem CFIP', 'Tipo', 'Última modificación', 'Estado']],\n          body: tableData,\n          startY: 25,\n          styles: {\n            fontSize: 8,\n            cellPadding: 2\n          },\n          headStyles: {\n            fillColor: [63, 81, 181],\n            textColor: 255,\n            fontSize: 9,\n            fontStyle: 'bold'\n          },\n          alternateRowStyles: {\n            fillColor: [245, 245, 245]\n          },\n          margin: {\n            top: 25\n          },\n          theme: 'grid'\n        });\n        //  Añadir marca de tiempo\n        const timestamp = `Fecha de generación: ${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}`;\n        doc.setFontSize(8);\n        doc.text(timestamp, 15, doc.internal.pageSize.height - 10);\n        //  Guardar PDF\n        doc.save(`Reporte_${new Date().toISOString().split('T')[0]}.pdf`);\n      } catch (error) {\n        console.error('Error al generar PDF:', error);\n        Swal.fire('Error', 'No se pudo generar el PDF', 'error');\n      }\n    }\n    getVisiblePages() {\n      const maxVisible = 6;\n      const totalPages = this.paginator.totalPages;\n      const currentPage = this.paginator.number + 1; // Convertir a índice basado en 1\n      let start = Math.max(1, currentPage - Math.floor(maxVisible / 2));\n      let end = start + maxVisible - 1;\n      if (end > totalPages) {\n        end = totalPages;\n        start = Math.max(1, end - maxVisible + 1);\n      }\n      return Array.from({\n        length: end - start + 1\n      }, (_, i) => start + i);\n    }\n    static #_ = (() => this.ɵfac = function TechnicalDataSheetsReportComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || TechnicalDataSheetsReportComponent)(i0.ɵɵdirectiveInject(i1.TechnicalDataSheetsReportService));\n    })();\n    static #_2 = (() => this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: TechnicalDataSheetsReportComponent,\n      selectors: [[\"app-technical-data-sheets-report\"]],\n      decls: 60,\n      vars: 15,\n      consts: [[\"noData\", \"\"], [1, \"filter-container\"], [\"for\", \"monthFilter\"], [\"id\", \"monthFilter\", 3, \"ngModelChange\", \"change\", \"ngModel\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"for\", \"yearFilter\"], [\"id\", \"yearFilter\", 3, \"ngModelChange\", \"change\", \"ngModel\"], [1, \"reset-button\", 3, \"click\"], [1, \"chart-container\", 2, \"width\", \"80%\", \"border\", \"solid 1px #3F51B5\", \"margin\", \"0 auto 50px\"], [\"id\", \"MyChart\", 2, \"padding\", \"25px\"], [1, \"card-body\"], [1, \"table-responsive\", \"mt-2\"], [\"id\", \"example23_wrapper\", 1, \"dataTables_wrapper\"], [1, \"filtro-container\", 2, \"width\", \"80%\", \"margin\", \"20px auto\", \"padding\", \"15px\", \"background-color\", \"#FFFFFF\", \"border-radius\", \"5px\", \"box-shadow\", \"0 2px 4px rgba(0,0,0,0.1)\"], [1, \"row\"], [1, \"col-md-3\"], [1, \"form-group\"], [\"type\", \"text\", \"placeholder\", \"Buscar en la tabla...\", 1, \"form-control\", 3, \"ngModelChange\", \"input\", \"ngModel\", \"disabled\"], [1, \"form-control\", 3, \"ngModelChange\", \"change\", \"ngModel\", \"disabled\"], [\"value\", \"todos\"], [\"value\", \"codigoItem\"], [\"value\", \"tipo\"], [\"value\", \"fecha\"], [\"value\", \"estado\"], [1, \"btn\", \"btn-secondary\", 2, \"width\", \"fit-content !important\", 3, \"click\", \"disabled\"], [4, \"ngIf\"], [1, \"btn\", \"btn-info\", 2, \"width\", \"fit-content !important\", \"font-size\", \"14px\", \"color\", \"#FFFFFF\", 3, \"click\"], [1, \"table\", 2, \"border\", \"solid 1px #393635\", \"width\", \"80%\", \"padding\", \"20px\", \"margin-top\", \"50px\", \"position\", \"relative\", \"margin\", \"20px auto\"], [\"scope\", \"col\"], [4, \"ngIf\", \"ngIfElse\"], [\"class\", \"row\", 4, \"ngIf\"], [3, \"value\"], [4, \"ngFor\", \"ngForOf\"], [\"scope\", \"row\"], [\"colspan\", \"5\", 2, \"text-align\", \"center\"], [\"id\", \"info\", \"role\", \"status\", \"aria-live\", \"polite\", 1, \"dataTables_info\"], [1, \"responsive-text\"], [\"class\", \"dataTables_paginate paging_simple_numbers responsive-text\", 4, \"ngIf\"], [1, \"dataTables_paginate\", \"paging_simple_numbers\", \"responsive-text\"], [\"class\", \"paginate_button previous\", \"aria-controls\", \"paginate\", \"data-dt-idx\", \"0\", \"tabindex\", \"0\", \"id\", \"previous\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"paginate_button next\", \"aria-controls\", \"next\", \"data-dt-idx\", \"7\", \"tabindex\", \"0\", \"id\", \"next\", 3, \"click\", 4, \"ngIf\"], [\"aria-controls\", \"paginate\", \"data-dt-idx\", \"0\", \"tabindex\", \"0\", \"id\", \"previous\", 1, \"paginate_button\", \"previous\", 3, \"click\"], [\"class\", \"paginate_button current\", \"aria-controls\", \"paginate\", \"data-dt-idx\", \"1\", \"tabindex\", \"0\", 4, \"ngIf\"], [\"class\", \"paginate_button\", \"aria-controls\", \"paginate\", \"data-dt-idx\", \"1\", \"tabindex\", \"0\", 3, \"click\", 4, \"ngIf\"], [\"aria-controls\", \"paginate\", \"data-dt-idx\", \"1\", \"tabindex\", \"0\", 1, \"paginate_button\", \"current\"], [\"aria-controls\", \"paginate\", \"data-dt-idx\", \"1\", \"tabindex\", \"0\", 1, \"paginate_button\", 3, \"click\"], [\"aria-controls\", \"next\", \"data-dt-idx\", \"7\", \"tabindex\", \"0\", \"id\", \"next\", 1, \"paginate_button\", \"next\", 3, \"click\"]],\n      template: function TechnicalDataSheetsReportComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          const _r1 = i0.ɵɵgetCurrentView();\n          i0.ɵɵelementStart(0, \"div\", 1)(1, \"label\", 2);\n          i0.ɵɵtext(2, \"Filtrar por mes:\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(3, \"select\", 3);\n          i0.ɵɵtwoWayListener(\"ngModelChange\", function TechnicalDataSheetsReportComponent_Template_select_ngModelChange_3_listener($event) {\n            i0.ɵɵrestoreView(_r1);\n            i0.ɵɵtwoWayBindingSet(ctx.selectedMonth, $event) || (ctx.selectedMonth = $event);\n            return i0.ɵɵresetView($event);\n          });\n          i0.ɵɵlistener(\"change\", function TechnicalDataSheetsReportComponent_Template_select_change_3_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.filterByMonth());\n          });\n          i0.ɵɵtemplate(4, TechnicalDataSheetsReportComponent_option_4_Template, 2, 2, \"option\", 4);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(5, \"label\", 5);\n          i0.ɵɵtext(6, \"A\\u00F1o:\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(7, \"select\", 6);\n          i0.ɵɵtwoWayListener(\"ngModelChange\", function TechnicalDataSheetsReportComponent_Template_select_ngModelChange_7_listener($event) {\n            i0.ɵɵrestoreView(_r1);\n            i0.ɵɵtwoWayBindingSet(ctx.selectedYear, $event) || (ctx.selectedYear = $event);\n            return i0.ɵɵresetView($event);\n          });\n          i0.ɵɵlistener(\"change\", function TechnicalDataSheetsReportComponent_Template_select_change_7_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.filterByMonth());\n          });\n          i0.ɵɵtemplate(8, TechnicalDataSheetsReportComponent_option_8_Template, 2, 2, \"option\", 4);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(9, \"button\", 7);\n          i0.ɵɵlistener(\"click\", function TechnicalDataSheetsReportComponent_Template_button_click_9_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.resetFilters());\n          });\n          i0.ɵɵtext(10, \"Limpiar\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(11, \"div\", 8)(12, \"canvas\", 9);\n          i0.ɵɵtext(13);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(14, \"div\", 10)(15, \"div\", 11)(16, \"div\", 12)(17, \"div\", 13)(18, \"div\", 14)(19, \"div\", 15)(20, \"div\", 16)(21, \"input\", 17);\n          i0.ɵɵtwoWayListener(\"ngModelChange\", function TechnicalDataSheetsReportComponent_Template_input_ngModelChange_21_listener($event) {\n            i0.ɵɵrestoreView(_r1);\n            i0.ɵɵtwoWayBindingSet(ctx.textoFiltro, $event) || (ctx.textoFiltro = $event);\n            return i0.ɵɵresetView($event);\n          });\n          i0.ɵɵlistener(\"input\", function TechnicalDataSheetsReportComponent_Template_input_input_21_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.aplicarFiltro());\n          });\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(22, \"div\", 15)(23, \"select\", 18);\n          i0.ɵɵtwoWayListener(\"ngModelChange\", function TechnicalDataSheetsReportComponent_Template_select_ngModelChange_23_listener($event) {\n            i0.ɵɵrestoreView(_r1);\n            i0.ɵɵtwoWayBindingSet(ctx.tipoFiltro, $event) || (ctx.tipoFiltro = $event);\n            return i0.ɵɵresetView($event);\n          });\n          i0.ɵɵlistener(\"change\", function TechnicalDataSheetsReportComponent_Template_select_change_23_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.aplicarFiltro());\n          });\n          i0.ɵɵelementStart(24, \"option\", 19);\n          i0.ɵɵtext(25, \"Buscar en todos los campos\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(26, \"option\", 20);\n          i0.ɵɵtext(27, \"C\\u00F3digo \\u00EDtem CFIP\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(28, \"option\", 21);\n          i0.ɵɵtext(29, \"Tipo\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(30, \"option\", 22);\n          i0.ɵɵtext(31, \"\\u00DAltima modificaci\\u00F3n\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(32, \"option\", 23);\n          i0.ɵɵtext(33, \"Estado\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(34, \"div\", 15)(35, \"button\", 24);\n          i0.ɵɵlistener(\"click\", function TechnicalDataSheetsReportComponent_Template_button_click_35_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.limpiarFiltro());\n          });\n          i0.ɵɵtemplate(36, TechnicalDataSheetsReportComponent_span_36_Template, 2, 0, \"span\", 25)(37, TechnicalDataSheetsReportComponent_span_37_Template, 2, 0, \"span\", 25);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(38, \"div\", 15)(39, \"button\", 26);\n          i0.ɵɵlistener(\"click\", function TechnicalDataSheetsReportComponent_Template_button_click_39_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.exportToExcel());\n          });\n          i0.ɵɵtext(40, \"Descargar Reporte\");\n          i0.ɵɵelementEnd()()()();\n          i0.ɵɵelementStart(41, \"table\", 27)(42, \"thead\")(43, \"tr\")(44, \"th\", 28);\n          i0.ɵɵtext(45, \"#\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(46, \"th\", 28);\n          i0.ɵɵtext(47, \"C\\u00F3digo \\u00EDtem CFIP\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(48, \"th\", 28);\n          i0.ɵɵtext(49, \"Tipo\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(50, \"th\", 28);\n          i0.ɵɵtext(51, \"Fecha de Creaci\\u00F3n\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(52, \"th\", 28);\n          i0.ɵɵtext(53, \"\\u00DAltima modificaci\\u00F3n\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(54, \"th\", 28);\n          i0.ɵɵtext(55, \"Estado\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵtemplate(56, TechnicalDataSheetsReportComponent_tbody_56_Template, 2, 1, \"tbody\", 29)(57, TechnicalDataSheetsReportComponent_ng_template_57_Template, 3, 0, \"ng-template\", null, 0, i0.ɵɵtemplateRefExtractor);\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(59, TechnicalDataSheetsReportComponent_div_59_Template, 7, 4, \"div\", 30);\n          i0.ɵɵelementEnd()()();\n        }\n        if (rf & 2) {\n          const noData_r11 = i0.ɵɵreference(58);\n          i0.ɵɵadvance(3);\n          i0.ɵɵtwoWayProperty(\"ngModel\", ctx.selectedMonth);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngForOf\", ctx.months);\n          i0.ɵɵadvance(3);\n          i0.ɵɵtwoWayProperty(\"ngModel\", ctx.selectedYear);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngForOf\", ctx.years);\n          i0.ɵɵadvance(5);\n          i0.ɵɵtextInterpolate(ctx.chart);\n          i0.ɵɵadvance(8);\n          i0.ɵɵtwoWayProperty(\"ngModel\", ctx.textoFiltro);\n          i0.ɵɵproperty(\"disabled\", ctx.loading);\n          i0.ɵɵadvance(2);\n          i0.ɵɵtwoWayProperty(\"ngModel\", ctx.tipoFiltro);\n          i0.ɵɵproperty(\"disabled\", ctx.loading);\n          i0.ɵɵadvance(12);\n          i0.ɵɵproperty(\"disabled\", ctx.loading || !ctx.textoFiltro && ctx.tipoFiltro === \"todos\");\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", !ctx.loading);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", ctx.loading);\n          i0.ɵɵadvance(19);\n          i0.ɵɵproperty(\"ngIf\", ctx.filteredTable.length > 0)(\"ngIfElse\", noData_r11);\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngIf\", ctx.paginator);\n        }\n      },\n      dependencies: [i2.NgForOf, i2.NgIf, i3.NgSelectOption, i3.ɵNgSelectMultipleOption, i3.DefaultValueAccessor, i3.SelectControlValueAccessor, i3.NgControlStatus, i3.NgModel, i2.DatePipe],\n      styles: [\".about-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;text-align:center}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000}.modal-content[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:8px;width:90%;max-width:400px;text-align:center}.modal-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:10px}.modal-close[_ngcontent-%COMP%]{margin-top:20px}td[_ngcontent-%COMP%], tr[_ngcontent-%COMP%]{border:solid 1px}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#3f51b5;color:#fff;text-align:center;border-left:solid 1px #67757c}.filtro-container[_ngcontent-%COMP%]{transition:all .3s ease}.filtro-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .filtro-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{height:38px;border:1px solid #ced4da;border-radius:4px}.filtro-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .filtro-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:#3f51b5;box-shadow:0 0 0 .2rem #3f51b540}.filtro-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:38px;width:120px}.filtro-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.table-responsive[_ngcontent-%COMP%]{overflow-x:hidden}.filter-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;justify-content:center;gap:10px;background:#fff;padding:12px 15px;border-radius:8px;width:80%;max-width:100%;box-shadow:0 4px 6px #0000001a;margin:10px auto}.filter-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;color:#3f51b5}.filter-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:6px 10px;border:2px solid #3F51B5;border-radius:6px;background:#fff;color:#3f51b5;font-weight:500;cursor:pointer}.filter-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#1e88e5}.reset-button[_ngcontent-%COMP%]{background:#3f51b5;color:#fff;border:none;padding:7px 15px;border-radius:6px;font-weight:600;cursor:pointer;transition:background .3s ease-in-out}.reset-button[_ngcontent-%COMP%]:hover{background:#1e88e5}@media (max-width: 768px){.filtro-container[_ngcontent-%COMP%]{width:95%;padding:10px}.filtro-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{flex-direction:column;align-items:center}.filtro-container[_ngcontent-%COMP%]   .col-md-3[_ngcontent-%COMP%]{width:100%;margin-bottom:10px}.filtro-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}.filter-container[_ngcontent-%COMP%]{flex-direction:column;width:95%;padding:10px}}\"]\n    }))();\n  }\n  return TechnicalDataSheetsReportComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}